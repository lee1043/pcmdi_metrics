
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Extremes &#8212; PMP Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="_static/jquery.js?v=5d32c60e"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=30646c52"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'metrics_ext';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Precipitation Variability Across Timescales" href="metrics_precip-variability.html" />
    <link rel="prev" title="Monsoon" href="metrics_monsoon.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/PMPLogo_500x421px_72dpi.png" class="logo__image only-light" alt="PMP Documentation - Home"/>
    <img src="_static/PMPLogo_500x421px_72dpi.png" class="logo__image only-dark pst-js-only" alt="PMP Documentation - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">For users:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="start.html">Getting Started</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="supporting-data.html">Retrieving data for demos and use of the PMP</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="metrics.html">PMP Metrics</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="metrics_mean-clim.html">Mean Climate</a></li>
<li class="toctree-l2"><a class="reference internal" href="metrics_enso.html">ENSO Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="metrics_mov.html">Extra-tropical modes of variability</a></li>
<li class="toctree-l2"><a class="reference internal" href="metrics_mjo.html">MJO baseline metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="metrics_monsoon.html">Monsoon</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Extremes</a></li>
<li class="toctree-l2"><a class="reference internal" href="metrics_precip-variability.html">Precipitation Variability Across Timescales</a></li>
<li class="toctree-l2"><a class="reference internal" href="metrics_precip-distribution.html">Precipitation Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="metrics_subdaily-precipitation.html">Sub-daily precipitation</a></li>
<li class="toctree-l2"><a class="reference internal" href="metrics_sea_ice.html">Sea Ice</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/PCMDI/pcmdi_metrics/blob/main/pcmdi_metrics/cloud_feedback/README.md">Cloud Feedbacks</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="metrics-demo.html">Demo notebooks</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="examples/Demo_0_download_data.html">0. Prepare Demos</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/Demo_1a_compute_climatologies.html">1A. Compute Climatologies</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/Demo_1b_mean_climate.html">1B. Mean Climate Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/Demo_2a_monsoon_wang.html">2A. Monsoon (Wang)</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/Demo_2b_monsoon_sperber.html">2B. Monsoon (Sperber)</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/Demo_3_diurnal_cycle.html">3. Diurnal Cycle</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/Demo_4_modes_of_variability.html">4. Modes of Variability</a></li>



<li class="toctree-l2"><a class="reference internal" href="examples/Demo_5_mjo_metrics.html">5. MJO</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/Demo_6_ENSO.html">6. ENSO</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/Demo_7_precip_variability.html">7. Precipitation Variability Across Timescales</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/Demo_8_extremes.html">8. Extremes Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/Demo_9_seaIceExtent_ivanova.html">9A. Sea Ice</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/Demo_9b_seaIce_data_explore.html">9B. Sea Ice Supplementary</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference external" href="https://pcmdi.llnl.gov/research/metrics/">Results</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">For developers/contributors:</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing Guide</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="resources.html">Resources</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="api.html">API Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.io.xcdat_open.html">pcmdi_metrics.io.xcdat_open</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.utils.create_land_sea_mask.html">pcmdi_metrics.utils.create_land_sea_mask</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.utils.apply_landmask.html">pcmdi_metrics.utils.apply_landmask</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.utils.apply_oceanmask.html">pcmdi_metrics.utils.apply_oceanmask</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.utils.create_target_grid.html">pcmdi_metrics.utils.create_target_grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.utils.regrid.html">pcmdi_metrics.utils.regrid</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.utils.custom_season_average.html">pcmdi_metrics.utils.custom_season_average</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.utils.custom_season_departure.html">pcmdi_metrics.utils.custom_season_departure</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.io.region_subset.html">pcmdi_metrics.io.region_subset</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.io.region_from_file.html">pcmdi_metrics.io.region_from_file</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.io.get_grid.html">pcmdi_metrics.io.get_grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.io.get_axis_list.html">pcmdi_metrics.io.get_axis_list</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.io.get_data_list.html">pcmdi_metrics.io.get_data_list</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.io.get_latitude.html">pcmdi_metrics.io.get_latitude</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.io.get_latitude_bounds.html">pcmdi_metrics.io.get_latitude_bounds</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.io.get_latitude_key.html">pcmdi_metrics.io.get_latitude_key</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.io.get_longitude.html">pcmdi_metrics.io.get_longitude</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.io.get_longitude_bounds.html">pcmdi_metrics.io.get_longitude_bounds</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.io.get_longitude_key.html">pcmdi_metrics.io.get_longitude_key</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.io.get_time.html">pcmdi_metrics.io.get_time</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.io.get_time_bounds.html">pcmdi_metrics.io.get_time_bounds</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.io.get_time_bounds_key.html">pcmdi_metrics.io.get_time_bounds_key</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.io.get_time_key.html">pcmdi_metrics.io.get_time_key</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.io.select_subset.html">pcmdi_metrics.io.select_subset</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.utils.check_daily_time_axis.html">pcmdi_metrics.utils.check_daily_time_axis</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.utils.check_monthly_time_axis.html">pcmdi_metrics.utils.check_monthly_time_axis</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.utils.regenerate_time_axis.html">pcmdi_metrics.utils.regenerate_time_axis</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.utils.sort_human.html">pcmdi_metrics.utils.sort_human</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.utils.fill_template.html">pcmdi_metrics.utils.fill_template</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pcmdi_metrics.utils.tree.html">pcmdi_metrics.utils.tree</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="resources_legacy.html">Legacy archive</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="pmp-using-cdp-guide.html">PMP using CDP Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="pmpparser.html">PMPParser</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="team.html">Team</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/PCMDI/pcmdi_metrics">GitHub repository</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://github.com/PCMDI/pcmdi_metrics/discussions">GitHub discussions</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/PCMDI/pcmdi_metrics" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/PCMDI/pcmdi_metrics/edit/main/docs/metrics_ext.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/PCMDI/pcmdi_metrics/issues/new?title=Issue%20on%20page%20%2Fmetrics_ext.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/metrics_ext.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Extremes</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#demo">Demo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inputs">Inputs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reference-data">Reference data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#land-sea-mask">Land/sea mask</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#covariate-data-and-stationarity">Covariate data and stationarity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regional-analysis">Regional Analysis</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run">Run</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#outputs">Outputs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metrics">Metrics</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parameters">Parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extreme-value-analysis-details">Extreme value analysis details</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reference">Reference</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="extremes">
<h1>Extremes<a class="headerlink" href="#extremes" title="Link to this heading">#</a></h1>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<p>The PMP Extremes driver produces annual block extrema and return values for daily temperature and precipitation data. The annual block extrema results include the <a class="reference external" href="http://etccdi.pacificclimate.org/list_27_indices.shtml">ETCCDI indices</a> Rx1day and Rx5day for precipitation and TX <sub>x</sub> , TX <sub>n</sub> , TN <sub>x</sub> , and TN <sub>n</sub>  for temperature.</p>
</section>
<section id="demo">
<h2>Demo<a class="headerlink" href="#demo" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/PCMDI/pcmdi_metrics/blob/main/doc/jupyter/Demo/Demo_8_extremes.ipynb">PMP demo Jupyter notebook</a></p></li>
</ul>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/PCMDI/pcmdi_metrics/blob/main/pcmdi_metrics/graphics/portrait_plot/return_value_portrait_plot_demo.ipynb">Extremes Portrait Plot demo Jupyter notebook</a></p></li>
</ul>
</section>
<section id="inputs">
<h2>Inputs<a class="headerlink" href="#inputs" title="Link to this heading">#</a></h2>
<p>The Extremes Driver works on daily gridded climate data. This package expects input NetCDF files to be cf-compliant and on regular latitude/longitude grids. X and Y dimensions must be named “lon” and “lat”, and the time dimension must be named “time”. The input variables must be called “tasmax”, “tasmin”, or “pr”. Input files must contain lat, lon, and time bounds.</p>
<section id="reference-data">
<h3>Reference data<a class="headerlink" href="#reference-data" title="Link to this heading">#</a></h3>
<p>A reference (observation) input is not required, but it is necessary to create (optional) Taylor Diagrams. Reference data sets must follow the above rules for variable names and bounds.</p>
</section>
<section id="land-sea-mask">
<h3>Land/sea mask<a class="headerlink" href="#land-sea-mask" title="Link to this heading">#</a></h3>
<p>Block extrema and return values will only be generated over land areas, so a land/sea mask is required for all datasets. Land is defined as grid cells where the land area percentage is between 50 and 100. Areas south of 50S will be masked out.</p>
<p>If available, users should provide the land/sea mask that accompanies their datasets. The mask variable in the land/sea mask file must be called “sftlf”. If land/sea masks are scaled from 0-1, they will be rescaled to 0-100 on-the-fly. If land/sea masks are not provided, there is an option to generate them on-the-fly using pcmdi_utils. See the parameters section for more information.</p>
</section>
<section id="covariate-data-and-stationarity">
<h3>Covariate data and stationarity<a class="headerlink" href="#covariate-data-and-stationarity" title="Link to this heading">#</a></h3>
<p>The extremes driver can produce nonstationary return values for model-only runs. To generate nonstationary return values, users must provide a covariate file path and name (see the parameters section for these settings). If no covariate file is provided, the Extremes Driver will generate stationary return values.</p>
<p>The covariate file must contain an annual time series of the covariate variable. Covariate data must be provided in a NetCDF file with time bounds included. The covariate time dimension must either 1) be exactly the same length in years as the input data, or 2) overlap in years with the input data time dimension. It is recommended that a log transformation be applied to nonlinear time series such as recent carbon dioxide values.</p>
</section>
<section id="regional-analysis">
<h3>Regional Analysis<a class="headerlink" href="#regional-analysis" title="Link to this heading">#</a></h3>
<p>You can either use a region from a shapefile or provide coordinate pairs that define the region. Consult the parameters section for more information.</p>
</section>
</section>
<section id="run">
<h2>Run<a class="headerlink" href="#run" title="Link to this heading">#</a></h2>
<p>To run the extremes metrics, use the following command format in a PMP environment:
<code class="docutils literal notranslate"><span class="pre">`extremes_driver.py</span> <span class="pre">-p</span> <span class="pre">parameter_file</span> <span class="pre">--other_params`</span></code></p>
</section>
<section id="outputs">
<h2>Outputs<a class="headerlink" href="#outputs" title="Link to this heading">#</a></h2>
<p>The outputs will be written to a single directory. This directory will be created by the driver if it does not already exist. Otherwise, the output directory should be empty before the driver starts. The name of the output directory is controlled by the <cite>metrics_output_path</cite> and <cite>case_id</cite> parameters.</p>
<p>This script will produce metrics JSONs, NetCDF files, and figures (optional). There will be NetCDF files containing block max/min values for temperature and/or precipitation, along with return value and standard error files. A metadata file called “output.json” will be generated with more detailed information about the files in the output bundle. Return value statistics will be provided for stationary return values only.</p>
<p>All NetCDF files will contain data for 5 time periods: Annual (“ANN”), DJF, MAM, JJA, and SON. Data is masked to be over land only (50&lt;=sftlf&lt;=100). Antarctica is excluded.</p>
<p>If multiple realizations are provided for a single model, a single return value file will be produced for that model which makes use of all provided realizations in the return value computation.</p>
<section id="metrics">
<h3>Metrics<a class="headerlink" href="#metrics" title="Link to this heading">#</a></h3>
<p>Metrics are produced to describe the time mean extrema values, along with spatial statistics comparing the mean model field to mean observed field. Metrics are output for Annual, DJF, MAM, JJA, and SON seasons.
Model only: “mean”, “std_xy”
If reference dataset is available: “mean”, “std_xy”, “std-obs_xy”, “pct_dif”, “bias_xy”, “cor_xy”, “mae_xy”, “rms_xy”, “rmsc_xy”</p>
</section>
</section>
<section id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Link to this heading">#</a></h2>
<p>The PMP extremes metrics can be controlled via an input parameter file, the command line, or both.  With the command line only it is executed via:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">extremes_driver</span><span class="o">.</span><span class="n">py</span>  <span class="o">-</span><span class="n">p</span> <span class="n">basic_param</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>or as a combination of an input parameter file and the command line, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">extremes_driver</span><span class="o">.</span><span class="n">py</span>  <span class="o">-</span><span class="n">p</span> <span class="n">basic_param</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="nb">vars</span> <span class="n">tasmax</span> <span class="n">pr</span>
</pre></div>
</div>
<p>The following parameters are <strong>required to be set by the user</strong> either in a parameter file or on the command line:</p>
<ul class="simple">
<li><p><strong>vars</strong>: List of variables. Allowed values are any of [‘pr’,’tasmax’,’tasmin’].</p></li>
<li><p><strong>model_list</strong>: List of model names.</p></li>
<li><p><strong>realization</strong>: List of realizations.</p></li>
<li><p><strong>test_data_path</strong>: File path to directory containing model/test data.</p></li>
<li><p><strong>filename_template</strong>: File name template for test data, e.g., “CMIP5.historical.%(model_version).r1i1p1.day.%(variable).19810101-200512.AC.v2019022512.nc” where “model_version” and “variable” will be analyzed for each of the entries in test_data_set and vars.</p></li>
<li><p><strong>metric_output_path</strong>: Directory path for metrics output in JSON files, e.g., ‘~/demo_data/PMP_metrics/’. The %(case_id) variable can be used here. If exists, should be empty before run.</p></li>
</ul>
<p>Reference data is optional, but the following parameters must be set when it is used:</p>
<ul class="simple">
<li><p><strong>reference_data_set</strong>: A short name describing the reference dataset, e.g. “GPCP-1-3”.</p></li>
<li><p><strong>reference_data_path</strong>: The reference data set file path.</p></li>
</ul>
<p>To generate nonstationary return values (test data set only), use the following parameters:</p>
<ul class="simple">
<li><p><strong>covariate_path</strong>: File path of covariate timeseries NetCDF. Must contain time bounds.</p></li>
<li><p><strong>covariate</strong>: Name of covariate variable in file given by –covariate_path.</p></li>
</ul>
<p>The output of the extremes summary statistics are saved in a JSON file.</p>
<p>In addition to the minimum set of parameters noted above, the following <strong>additional options can be controlled</strong>:</p>
<ul class="simple">
<li><p><strong>djf_mode</strong>: Toggle how season containing December, January, and February is defined. “DJF” or “JFD”. Default “DJF”.</p></li>
<li><p><strong>annual_strict</strong>: This only matters for Rx5day. If True, only use data from within a given year in the 5-day means. If False, the rolling mean will include the last 4 days of the prior year. Default False.</p></li>
<li><p><strong>drop_incomplete_djf</strong>: If True, don’t include data from the first January/February and last December in the analysis. Default False.</p></li>
<li><p><strong>sftlf_filename_template</strong>: The template for the test land/sea mask file. May contain placeholders %(model), %(model_version), or %(realization).</p></li>
<li><p><strong>sftlf_filename_template</strong>: The template for the reference land/sea mask file.</p></li>
<li><p><strong>generate_sftlf</strong>: Estimate a land-sea mask. If used in conjuction with –sftlf_filename_template, the template takes precedence.</p></li>
<li><p><strong>case_id</strong>: Save JSON and netCDF files into a subdirectory so that results from multiple tests can be readily organized.</p></li>
<li><p><strong>plots</strong>: Set to True to save world maps and Taylor Diagrams</p></li>
<li><p><strong>msyear</strong>: Start year for test data set.</p></li>
<li><p><strong>meyear</strong>: End year for test data set.</p></li>
<li><p><strong>osyear</strong>: Start year for reference data set.</p></li>
<li><p><strong>oeyear</strong>: End year for reference data set.</p></li>
<li><p><strong>regrid</strong>: Set to False to skip regridding if all test and reference data sets are on the same grid.</p></li>
<li><p><strong>ModUnitsAdjust</strong>: Provide information for units conversion. Uses format (flag (bool), operation (str), value (float), new units (str)). Operation can be “add”, “subtract”, “multiply”, or “divide”. For example, use (True, ‘multiply’, 86400, ‘mm/day’) to convert kg/m2/s to mm/day.</p></li>
<li><p><strong>ObsUnitsAdjust</strong>: Similar to ModUnitsAdjust, but for reference dataset.</p></li>
</ul>
<p>The following parameters are used for regional analysis using a shapefile:</p>
<ul class="simple">
<li><p><strong>shp_path</strong>: Path to shapefile.</p></li>
<li><p><strong>attribute</strong>: Attribute used to identify region (eg, column of attribute table). For example, “COUNTRY” in a shapefile of countries.</p></li>
<li><p><strong>region_name</strong>: Unique feature value of the region that occurs in the attribute given by “–attribute”. Must match only one geometry in the shapefile. An example is “NORTH_AMERICA” under the attribute “CONTINENTS”.</p></li>
</ul>
<p>These parameters are used for regional analysis using a coordinate list:</p>
<ul class="simple">
<li><p><strong>coords</strong>: Coordinate lat/lon pair lists. The coordinate must be listed in consecutive order, as they would occur when walking the perimeter of the bounding shape. Does not need to be a box, but cannot have holes. For example [[lat1,lon1],[lat1,lon2],[lat2,lon2],[lat2,lon1]].</p></li>
<li><p><strong>region_name</strong>: Name of region. Default is “custom”.</p></li>
</ul>
</section>
<section id="extreme-value-analysis-details">
<h2>Extreme value analysis details<a class="headerlink" href="#extreme-value-analysis-details" title="Link to this heading">#</a></h2>
<p>For this driver, we have implemented the Generalized Extreme Value analysis in pure Python. The return value results may vary from those obtained with the R climextRemes package, which was used to conduct the return value analysis in Wehner, Gleckler, and Lee (2000). In the nonstationary case, the GEV location parameter is linearly dependent on the covariate.</p>
</section>
<section id="reference">
<h2>Reference<a class="headerlink" href="#reference" title="Link to this heading">#</a></h2>
<p>Michael Wehner, Peter Gleckler, Jiwoo Lee, 2020: Characterization of long period return values of extreme daily temperature and precipitation in the CMIP6 models: Part 1, model evaluation, Weather and Climate Extremes, 30, 100283, <a class="reference external" href="https://doi.org/10.1016/j.wace.2020.100283">https://doi.org/10.1016/j.wace.2020.100283</a>.</p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="metrics_monsoon.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Monsoon</p>
      </div>
    </a>
    <a class="right-next"
       href="metrics_precip-variability.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Precipitation Variability Across Timescales</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#demo">Demo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inputs">Inputs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reference-data">Reference data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#land-sea-mask">Land/sea mask</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#covariate-data-and-stationarity">Covariate data and stationarity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regional-analysis">Regional Analysis</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run">Run</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#outputs">Outputs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metrics">Metrics</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parameters">Parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extreme-value-analysis-details">Extreme value analysis details</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reference">Reference</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By PMP Developers
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024, PMP Developers.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>