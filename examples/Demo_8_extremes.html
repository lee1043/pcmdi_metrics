
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>8. Extremes Metrics &#8212; PMP Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=30646c52"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/Demo_8_extremes';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="9A. Sea Ice" href="Demo_9_seaIceExtent_ivanova.html" />
    <link rel="prev" title="7. Precipitation Variability Across Timescales" href="Demo_7_precip_variability.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/PMPLogo_500x421px_72dpi.png" class="logo__image only-light" alt="PMP Documentation - Home"/>
    <img src="../_static/PMPLogo_500x421px_72dpi.png" class="logo__image only-dark pst-js-only" alt="PMP Documentation - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">For users:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../start.html">Getting Started</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../supporting-data.html">Retrieving data for demos and use of the PMP</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../metrics.html">PMP Metrics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../metrics_mean-clim.html">Mean Climate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics_enso.html">ENSO Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics_mov.html">Extra-tropical modes of variability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics_mjo.html">MJO baseline metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics_monsoon.html">Monsoon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics_ext.html">Extremes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics_precip-variability.html">Precipitation Variability Across Timescales</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics_precip-distribution.html">Precipitation Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics_subdaily-precipitation.html">Sub-daily precipitation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics_sea_ice.html">Sea Ice</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/PCMDI/pcmdi_metrics/blob/main/pcmdi_metrics/cloud_feedback/README.md">Cloud Feedbacks</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../metrics-demo.html">Demo notebooks</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Demo_0_download_data.html">0. Prepare Demos</a></li>
<li class="toctree-l2"><a class="reference internal" href="Demo_1a_compute_climatologies.html">1A. Compute Climatologies</a></li>
<li class="toctree-l2"><a class="reference internal" href="Demo_1b_mean_climate.html">1B. Mean Climate Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="Demo_2a_monsoon_wang.html">2A. Monsoon (Wang)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Demo_2b_monsoon_sperber.html">2B. Monsoon (Sperber)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Demo_3_diurnal_cycle.html">3. Diurnal Cycle</a></li>
<li class="toctree-l2"><a class="reference internal" href="Demo_4_modes_of_variability.html">4. Modes of Variability</a></li>



<li class="toctree-l2"><a class="reference internal" href="Demo_5_mjo_metrics.html">5. MJO</a></li>
<li class="toctree-l2"><a class="reference internal" href="Demo_6_ENSO.html">6. ENSO</a></li>
<li class="toctree-l2"><a class="reference internal" href="Demo_7_precip_variability.html">7. Precipitation Variability Across Timescales</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">8. Extremes Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="Demo_9_seaIceExtent_ivanova.html">9A. Sea Ice</a></li>
<li class="toctree-l2"><a class="reference internal" href="Demo_9b_seaIce_data_explore.html">9B. Sea Ice Supplementary</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference external" href="https://pcmdi.llnl.gov/research/metrics/">Results</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">For developers/contributors:</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing Guide</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../resources.html">Resources</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api.html">API Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.io.xcdat_open.html">pcmdi_metrics.io.xcdat_open</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.utils.create_land_sea_mask.html">pcmdi_metrics.utils.create_land_sea_mask</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.utils.apply_landmask.html">pcmdi_metrics.utils.apply_landmask</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.utils.apply_oceanmask.html">pcmdi_metrics.utils.apply_oceanmask</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.utils.create_target_grid.html">pcmdi_metrics.utils.create_target_grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.utils.regrid.html">pcmdi_metrics.utils.regrid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.utils.custom_season_average.html">pcmdi_metrics.utils.custom_season_average</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.utils.custom_season_departure.html">pcmdi_metrics.utils.custom_season_departure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.io.region_subset.html">pcmdi_metrics.io.region_subset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.io.region_from_file.html">pcmdi_metrics.io.region_from_file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.io.get_grid.html">pcmdi_metrics.io.get_grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.io.get_axis_list.html">pcmdi_metrics.io.get_axis_list</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.io.get_data_list.html">pcmdi_metrics.io.get_data_list</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.io.get_latitude.html">pcmdi_metrics.io.get_latitude</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.io.get_latitude_bounds.html">pcmdi_metrics.io.get_latitude_bounds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.io.get_latitude_key.html">pcmdi_metrics.io.get_latitude_key</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.io.get_longitude.html">pcmdi_metrics.io.get_longitude</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.io.get_longitude_bounds.html">pcmdi_metrics.io.get_longitude_bounds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.io.get_longitude_key.html">pcmdi_metrics.io.get_longitude_key</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.io.get_time.html">pcmdi_metrics.io.get_time</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.io.get_time_bounds.html">pcmdi_metrics.io.get_time_bounds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.io.get_time_bounds_key.html">pcmdi_metrics.io.get_time_bounds_key</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.io.get_time_key.html">pcmdi_metrics.io.get_time_key</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.io.select_subset.html">pcmdi_metrics.io.select_subset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.utils.check_daily_time_axis.html">pcmdi_metrics.utils.check_daily_time_axis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.utils.check_monthly_time_axis.html">pcmdi_metrics.utils.check_monthly_time_axis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.utils.regenerate_time_axis.html">pcmdi_metrics.utils.regenerate_time_axis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.utils.sort_human.html">pcmdi_metrics.utils.sort_human</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.utils.fill_template.html">pcmdi_metrics.utils.fill_template</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/pcmdi_metrics.utils.tree.html">pcmdi_metrics.utils.tree</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../resources_legacy.html">Legacy archive</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../pmp-using-cdp-guide.html">PMP using CDP Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pmpparser.html">PMPParser</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../team.html">Team</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/PCMDI/pcmdi_metrics">GitHub repository</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://github.com/PCMDI/pcmdi_metrics/discussions">GitHub discussions</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/PCMDI/pcmdi_metrics" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/PCMDI/pcmdi_metrics/edit/main/docs/examples/Demo_8_extremes.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/PCMDI/pcmdi_metrics/issues/new?title=Issue%20on%20page%20%2Fexamples/Demo_8_extremes.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/examples/Demo_8_extremes.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>8. Extremes Metrics</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Create-low-resolution-datasets">Create low resolution datasets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Basic-Use">Basic Use</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#How-to-run">How to run</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Customizing-parameters-in-the-extremes-driver">Customizing parameters in the extremes driver</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Coordinate-method">Coordinate method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Shapefile-method">Shapefile method</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Other-options">Other options</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Clean-up">Clean up</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="8.-Extremes-Metrics">
<h1>8. Extremes Metrics<a class="headerlink" href="#8.-Extremes-Metrics" title="Link to this heading">#</a></h1>
<p>This notebook shows users how to run the PMP Extremes metrics driver. This driver can produce annual and seasonal block extremes and return values for temperature or precipitation data.</p>
<p>This notebook should be run in an environment with python, jupyterlab, pcmdi metrics package, and cdat installed. It is expected that you have downloaded the sample data as demonstrated in the download notebook.</p>
<p>The following cell reads in the choices you made during the download data step:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">user_choices</span> <span class="kn">import</span> <span class="n">demo_data_directory</span><span class="p">,</span> <span class="n">demo_output_directory</span>
</pre></div>
</div>
</div>
<section id="Create-low-resolution-datasets">
<h2>Create low resolution datasets<a class="headerlink" href="#Create-low-resolution-datasets" title="Link to this heading">#</a></h2>
<p>This next cell creates very low resolution versions of the input datasets to speed up the demo.</p>
<p>This step is for the purposes of this demo only. Do not follow this step when working with your own data.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">xcdat</span> <span class="k">as</span> <span class="nn">xc</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up sample data for demo</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">demo_output_directory</span><span class="p">,</span> <span class="s2">&quot;extremes_tmp&quot;</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">make_lower_resolution_model_data_for_demo</span><span class="p">(</span><span class="n">inpath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">outpath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">outpath</span><span class="p">)</span> <span class="ow">or</span> <span class="n">overwrite</span><span class="p">:</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">xc</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">inpath</span><span class="p">)</span>
        <span class="n">out_grid</span> <span class="o">=</span> <span class="n">xc</span><span class="o">.</span><span class="n">create_uniform_grid</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mf">10.</span><span class="p">)</span>
        <span class="n">output_data</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">regridder</span><span class="o">.</span><span class="n">horizontal</span><span class="p">(</span><span class="s2">&quot;pr&quot;</span><span class="p">,</span> <span class="n">out_grid</span><span class="p">,</span> <span class="n">tool</span><span class="o">=</span><span class="s2">&quot;regrid2&quot;</span><span class="p">)</span>
        <span class="n">output_data</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">outpath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>

<span class="c1"># Make low resolution model data</span>
<span class="n">inpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">demo_data_directory</span><span class="p">,</span> <span class="s2">&quot;CMIP5_demo_timeseries/historical/atmos/day/pr/pr_day_GISS-E2-H_historical_r6i1p1_20000101-20051231.nc&quot;</span><span class="p">)</span>
<span class="n">outpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">demo_output_directory</span><span class="p">,</span> <span class="s2">&quot;extremes_tmp/pr_day_GISS-E2-H_historical_r6i1p1_20000101-20051231.nc&quot;</span><span class="p">)</span>
<span class="n">make_lower_resolution_model_data_for_demo</span><span class="p">(</span><span class="n">inpath</span><span class="p">,</span> <span class="n">outpath</span><span class="p">)</span>

<span class="c1"># Make low resolution obs data</span>
<span class="n">inpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">demo_data_directory</span><span class="p">,</span> <span class="s2">&quot;obs4MIPs_PCMDI_daily/NASA-JPL/GPCP-1-3/day/pr/gn/latest/pr_day_GPCP-1-3_PCMDI_gn_19961002-20170101.nc&quot;</span><span class="p">)</span>
<span class="n">outpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">demo_output_directory</span><span class="p">,</span> <span class="s2">&quot;extremes_tmp/pr_day_GPCP-1-3_PCMDI_gn_19961002-20170101.nc&quot;</span><span class="p">)</span>
<span class="n">make_lower_resolution_model_data_for_demo</span><span class="p">(</span><span class="n">inpath</span><span class="p">,</span> <span class="n">outpath</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Basic-Use">
<h2>Basic Use<a class="headerlink" href="#Basic-Use" title="Link to this heading">#</a></h2>
<p>The PMP Extremes driver is controlled via a parameter file. The parameter file for this demo is shown here:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;basic_extremes_param.py&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
# Settings for extremes driver

# These settings are required
vars = [&#39;pr&#39;] # Choices are &#39;pr&#39;,&#39;tasmax&#39;, &#39;tasmin&#39;
test_data_set = [&#39;GISS-E2-H&#39;]
realization = [&#39;r6i1p1&#39;]
test_data_path = &#39;demo_output/extremes_tmp/&#39;
filename_template = &#39;%(variable)_day_%(model)_historical_%(realization)_20000101-20051231.nc&#39;
metrics_output_path = &#39;demo_output/%(case_id)&#39;

# Note: You can use the following placeholders in file templates:
# %(variable) to substitute variable name from &#34;vars&#34; (except in sftlf filenames)
# %(model) to substitute model name from &#34;test_data_set&#34;
# %(realization) to substitute realization from &#34;realization&#34;

# Optional settings
# See the README for more information about these settings
case_id = &#39;extremes_ex1&#39;
#sftlf_filename_template = &#39;demo_data/CMIP5_demo_data/cmip5.historical.%(model).sftlf.nc&#39;

ModUnitsAdjust = (True,&#39;multiply&#39;,86400.,&#39;mm/day&#39;) # Convert model units from kg/m2/s to mm/day
ObsUnitsAdjust = (True,&#39;multiply&#39;,86400.,&#39;mm/day&#39;) # Convert obs units
dec_mode=&#39;JFD&#39;
annual_strict = True
drop_incomplete_djf = True
regrid=False
plots=False
generate_sftlf = True
return_period = 2

</pre></div></div>
</div>
<section id="How-to-run">
<h3>How to run<a class="headerlink" href="#How-to-run" title="Link to this heading">#</a></h3>
<p>To run the extremes driver, use the following command in the terminal. This will generate a metrics file based on the models, observations, and other criteria in <code class="docutils literal notranslate"><span class="pre">basic_param.py</span></code></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>extremes_driver.py -p basic_extremes_param.py
</pre></div>
</div>
<p>This driver takes daily data on a regular lat/lon grid. The input variables can be precipitation (pr), maximum daily temperature (tasmax), or minimum daily temperature (tasmin).</p>
<p>In the next cell, bash cell magic is used to run the driver as a subprocess (this may take several minutes):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>%%bash
extremes_driver.py<span class="w">  </span>-p<span class="w"> </span>basic_extremes_param.py
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO::2023-12-23 09:52::pcmdi_metrics:: Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex1/GISS-E2-H_block_extremes_metrics.json
2023-12-23 09:52:54,152 [INFO]: base.py(write:251) &gt;&gt; Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex1/GISS-E2-H_block_extremes_metrics.json
2023-12-23 09:52:54,152 [INFO]: base.py(write:251) &gt;&gt; Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex1/GISS-E2-H_block_extremes_metrics.json
INFO::2023-12-23 09:53::pcmdi_metrics:: Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex1/block_extremes_metrics.json
2023-12-23 09:53:09,441 [INFO]: base.py(write:251) &gt;&gt; Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex1/block_extremes_metrics.json
2023-12-23 09:53:09,441 [INFO]: base.py(write:251) &gt;&gt; Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex1/block_extremes_metrics.json
  warnings.warn(str(msg))
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1584: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:423: RuntimeWarning: overflow encountered in power
  result = np.sum(np.log(scale) + y**(-1 / shape) + np.log(y)*(1/shape + 1))
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1584: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1584: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1584: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1584: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1584: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1584: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1584: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:423: RuntimeWarning: overflow encountered in power
  result = np.sum(np.log(scale) + y**(-1 / shape) + np.log(y)*(1/shape + 1))
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1584: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:423: RuntimeWarning: overflow encountered in power
  result = np.sum(np.log(scale) + y**(-1 / shape) + np.log(y)*(1/shape + 1))
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:423: RuntimeWarning: overflow encountered in power
  result = np.sum(np.log(scale) + y**(-1 / shape) + np.log(y)*(1/shape + 1))
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:423: RuntimeWarning: overflow encountered in power
  result = np.sum(np.log(scale) + y**(-1 / shape) + np.log(y)*(1/shape + 1))
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:423: RuntimeWarning: overflow encountered in power
  result = np.sum(np.log(scale) + y**(-1 / shape) + np.log(y)*(1/shape + 1))
2023-10-19 16:00:57,855 [WARNING]: dataset.py(open_dataset:109) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1879: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1879: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1879: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1879: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1879: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
2023-10-19 16:00:58,459 [WARNING]: dataset.py(open_dataset:109) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1879: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/home/ordonez4/miniconda3/envs/pmp_climex_2/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1879: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:484: RuntimeWarning: invalid value encountered in sqrt
  se = np.sqrt(np.diag(B))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Metrics output path not found.
Creating metrics output directory demo_output/extremes_ex1
No sftlf file found for GISS-E2-H r6i1p1

-----------------------
model, run, variable: GISS-E2-H r6i1p1 pr
test_data (model in this case) full_path:
   demo_output/extremes_tmp/pr_day_GISS-E2-H_historical_r6i1p1_20000101-20051231.nc
Generating land sea mask.
Generating precipitation block extrema.
Writing results to netCDF.
Generating metrics.
Generating return values.
demo_output/extremes_ex1/netcdf/GISS-E2-H_r6i1p1_land_Rx5day_2000-2005.nc
Return value for single realization
Stationary case
demo_output/extremes_ex1/netcdf/GISS-E2-H_r6i1p1_land_Rx1day_2000-2005.nc
Return value for single realization
Stationary case
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:484: RuntimeWarning: invalid value encountered in sqrt
  se = np.sqrt(np.diag(B))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
2023-12-23 09:58:00,844 [WARNING]: dataset.py(open_dataset:128) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
2023-12-23 09:58:00,844 [WARNING]: dataset.py(open_dataset:128) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
2023-12-23 09:58:02,050 [WARNING]: dataset.py(open_dataset:128) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
2023-12-23 09:58:02,050 [WARNING]: dataset.py(open_dataset:128) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
INFO::2023-12-23 09:58::pcmdi_metrics:: Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex1/return_value_metrics.json
2023-12-23 09:58:19,524 [INFO]: base.py(write:251) &gt;&gt; Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex1/return_value_metrics.json
2023-12-23 09:58:19,524 [INFO]: base.py(write:251) &gt;&gt; Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex1/return_value_metrics.json
</pre></div></div>
</div>
<p>Running the mean climate driver produces an output json file in the demo output directory. The metrics are stored in the “RESULTS” object of the json. Since only one model was provided as input, the only metrics generated are the overall mean and spatial standard deviation of the time mean.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="n">output_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">demo_output_directory</span><span class="p">,</span> <span class="s2">&quot;extremes_ex1/GISS-E2-H_block_extremes_metrics.json&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">metric</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)[</span><span class="s2">&quot;RESULTS&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{
  &#34;GISS-E2-H&#34;: {
    &#34;r6i1p1&#34;: {
      &#34;Rx1day&#34;: {
        &#34;land&#34;: {
          &#34;mean&#34;: {
            &#34;ANN&#34;: 13.893658659590225,
            &#34;DJF&#34;: 9.31502969871792,
            &#34;JJA&#34;: 9.874547701271384,
            &#34;MAM&#34;: 9.673421213370716,
            &#34;SON&#34;: 10.26557454847975
          },
          &#34;std_xy&#34;: {
            &#34;ANN&#34;: 5.945030862687258,
            &#34;DJF&#34;: 6.146237023726763,
            &#34;JJA&#34;: 5.5616445472124205,
            &#34;MAM&#34;: 5.691253427868338,
            &#34;SON&#34;: 4.706666979280209
          }
        }
      },
      &#34;Rx5day&#34;: {
        &#34;land&#34;: {
          &#34;mean&#34;: {
            &#34;ANN&#34;: 8.671242963046646,
            &#34;DJF&#34;: 5.676891390638716,
            &#34;JJA&#34;: 6.3377633184316595,
            &#34;MAM&#34;: 5.979513632245038,
            &#34;SON&#34;: 6.398284822480362
          },
          &#34;std_xy&#34;: {
            &#34;ANN&#34;: 4.360349983232101,
            &#34;DJF&#34;: 4.075258006799149,
            &#34;JJA&#34;: 4.252590359970838,
            &#34;MAM&#34;: 3.9340937638845,
            &#34;SON&#34;: 3.5241812625764277
          }
        }
      }
    }
  }
}
</pre></div></div>
</div>
<p>There is a also a JSON file containing metrics for the return values in the output directory. All of the model results are found in this file.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">demo_output_directory</span><span class="p">,</span> <span class="s2">&quot;extremes_ex1/return_value_metrics.json&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">metric</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)[</span><span class="s2">&quot;RESULTS&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{
  &#34;GISS-E2-H&#34;: {
    &#34;r6i1p1&#34;: {
      &#34;Rx1day&#34;: {
        &#34;land&#34;: {
          &#34;mean&#34;: {
            &#34;ANN&#34;: 13.624745420109296,
            &#34;DJF&#34;: 9.135198382216965,
            &#34;JJA&#34;: 9.69544213448287,
            &#34;MAM&#34;: 9.494820971523852,
            &#34;SON&#34;: 10.085447982915195
          },
          &#34;std_xy&#34;: {
            &#34;ANN&#34;: 5.84905794939727,
            &#34;DJF&#34;: 6.013623428632656,
            &#34;JJA&#34;: 5.727349593864466,
            &#34;MAM&#34;: 5.823259373316453,
            &#34;SON&#34;: 4.879802456134834
          }
        }
      },
      &#34;Rx5day&#34;: {
        &#34;land&#34;: {
          &#34;mean&#34;: {
            &#34;ANN&#34;: 8.612002894301867,
            &#34;DJF&#34;: 5.639755083301711,
            &#34;JJA&#34;: 6.327901109603924,
            &#34;MAM&#34;: 5.881137864856613,
            &#34;SON&#34;: 6.4227782133202105
          },
          &#34;std_xy&#34;: {
            &#34;ANN&#34;: 4.350524537048482,
            &#34;DJF&#34;: 4.133374175749511,
            &#34;JJA&#34;: 4.293717108920656,
            &#34;MAM&#34;: 3.970563425657647,
            &#34;SON&#34;: 3.6943723619808524
          }
        }
      }
    }
  }
}
</pre></div></div>
</div>
<p>In addition, the Extremes Driver saves netcdf files containing the block extremes, the return values, and the standard error for the return values. The standard error can be used to calculate confidence intervals. These files can be found in a “netcdf” subfolder of the output directory, as demonstrated here:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>ls<span class="w"> </span><span class="o">{</span>demo_output_directory<span class="w"> </span>+<span class="w"> </span><span class="s2">&quot;/extremes_ex1/netcdf/*.nc&quot;</span><span class="o">}</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
demo_output/extremes_ex1/netcdf/GISS-E2-H_r6i1p1_land_Rx1day_2000-2005.nc
demo_output/extremes_ex1/netcdf/GISS-E2-H_r6i1p1_land_Rx1day_2000-2005_return_value.nc
demo_output/extremes_ex1/netcdf/GISS-E2-H_r6i1p1_land_Rx1day_2000-2005_standard_error.nc
demo_output/extremes_ex1/netcdf/GISS-E2-H_r6i1p1_land_Rx5day_2000-2005.nc
demo_output/extremes_ex1/netcdf/GISS-E2-H_r6i1p1_land_Rx5day_2000-2005_return_value.nc
demo_output/extremes_ex1/netcdf/GISS-E2-H_r6i1p1_land_Rx5day_2000-2005_standard_error.nc
</pre></div></div>
</div>
</section>
</section>
<section id="Customizing-parameters-in-the-extremes-driver">
<h2>Customizing parameters in the extremes driver<a class="headerlink" href="#Customizing-parameters-in-the-extremes-driver" title="Link to this heading">#</a></h2>
<p>It is possible to override the parameter file from the command line. Use <code class="docutils literal notranslate"><span class="pre">pmp_extremes_driver.py</span> <span class="pre">--help</span></code> to see all the flag options.</p>
<p>A reference data set (e.g. observations or a control run) can be provided to generate additional metrics. Each test data set will be compared to this reference.</p>
<p>These are the parameters that control the reference data settings:</p>
<div class="line-block">
<div class="line">–reference_data_path: The file path for the reference data set.</div>
<div class="line">–reference_data_set: A short name for the reference data set.</div>
<div class="line">–reference_sftlf_template: The file path for the reference land/sea mask (optional if –generate_sftlf = True).</div>
<div class="line">–ObsUnitsAdjust: Tuple that controls obs units conversion (in this example, to mm/day).</div>
</div>
<p>An example of using reference data is shown next:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>%%bash
extremes_driver.py<span class="w">  </span>-p<span class="w"> </span>basic_extremes_param.py<span class="w"> </span><span class="se">\</span>
--case_id<span class="w"> </span>extremes_ex2<span class="w"> </span><span class="se">\</span>
--reference_data_path<span class="w"> </span>demo_output/extremes_tmp/pr_day_GPCP-1-3_PCMDI_gn_19961002-20170101.nc<span class="w">  </span><span class="se">\</span>
--reference_data_set<span class="w"> </span>GPCP-1-3<span class="w"> </span><span class="se">\</span>
--generate_sftlf<span class="w"> </span><span class="se">\</span>
--regrid<span class="w"> </span>True
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
No reference sftlf file template provided.

-----------------------
model, run, variable: Reference GPCP-1-3 pr
test_data (model in this case) full_path:
   demo_output/extremes_tmp/pr_day_GPCP-1-3_PCMDI_gn_19961002-20170101.nc
Generating land sea mask.
Generating precipitation block extrema.
Writing results to netCDF.
No sftlf file found for GISS-E2-H r6i1p1

-----------------------
model, run, variable: GISS-E2-H r6i1p1 pr
test_data (model in this case) full_path:
   demo_output/extremes_tmp/pr_day_GISS-E2-H_historical_r6i1p1_20000101-20051231.nc
Generating land sea mask.
Generating precipitation block extrema.
Writing results to netCDF.
Generating metrics.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO::2023-12-23 09:59::pcmdi_metrics:: Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex2/GISS-E2-H_block_extremes_metrics.json
2023-12-23 09:59:11,868 [INFO]: base.py(write:251) &gt;&gt; Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex2/GISS-E2-H_block_extremes_metrics.json
2023-12-23 09:59:11,868 [INFO]: base.py(write:251) &gt;&gt; Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex2/GISS-E2-H_block_extremes_metrics.json
INFO::2023-12-23 09:59::pcmdi_metrics:: Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex2/block_extremes_metrics.json
2023-12-23 09:59:26,902 [INFO]: base.py(write:251) &gt;&gt; Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex2/block_extremes_metrics.json
2023-12-23 09:59:26,902 [INFO]: base.py(write:251) &gt;&gt; Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex2/block_extremes_metrics.json
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generating return values.
demo_output/extremes_ex2/netcdf/Reference_GPCP-1-3_land_Rx5day_1996-2017.nc
Return value for single realization
Stationary case
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
demo_output/extremes_ex2/netcdf/Reference_GPCP-1-3_land_Rx1day_1996-2017.nc
Return value for single realization
Stationary case
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:484: RuntimeWarning: invalid value encountered in sqrt
  se = np.sqrt(np.diag(B))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
demo_output/extremes_ex2/netcdf/GISS-E2-H_r6i1p1_land_Rx5day_2000-2005.nc
Return value for single realization
Stationary case
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:484: RuntimeWarning: invalid value encountered in sqrt
  se = np.sqrt(np.diag(B))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
demo_output/extremes_ex2/netcdf/GISS-E2-H_r6i1p1_land_Rx1day_2000-2005.nc
Return value for single realization
Stationary case
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:484: RuntimeWarning: invalid value encountered in sqrt
  se = np.sqrt(np.diag(B))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
2023-12-23 10:08:14,726 [WARNING]: dataset.py(open_dataset:128) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
2023-12-23 10:08:14,726 [WARNING]: dataset.py(open_dataset:128) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
2023-12-23 10:08:14,973 [WARNING]: dataset.py(open_dataset:128) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
2023-12-23 10:08:14,973 [WARNING]: dataset.py(open_dataset:128) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
2023-12-23 10:08:22,427 [WARNING]: dataset.py(open_dataset:128) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
2023-12-23 10:08:22,427 [WARNING]: dataset.py(open_dataset:128) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
2023-12-23 10:08:22,575 [WARNING]: dataset.py(open_dataset:128) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
2023-12-23 10:08:22,575 [WARNING]: dataset.py(open_dataset:128) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
2023-12-23 10:08:29,821 [WARNING]: dataset.py(open_dataset:128) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
2023-12-23 10:08:29,821 [WARNING]: dataset.py(open_dataset:128) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
2023-12-23 10:08:29,980 [WARNING]: dataset.py(open_dataset:128) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
2023-12-23 10:08:29,980 [WARNING]: dataset.py(open_dataset:128) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
2023-12-23 10:08:36,321 [WARNING]: dataset.py(open_dataset:128) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
2023-12-23 10:08:36,321 [WARNING]: dataset.py(open_dataset:128) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
2023-12-23 10:08:36,452 [WARNING]: dataset.py(open_dataset:128) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
2023-12-23 10:08:36,452 [WARNING]: dataset.py(open_dataset:128) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
INFO::2023-12-23 10:08::pcmdi_metrics:: Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex2/return_value_metrics.json
2023-12-23 10:08:58,977 [INFO]: base.py(write:251) &gt;&gt; Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex2/return_value_metrics.json
2023-12-23 10:08:58,977 [INFO]: base.py(write:251) &gt;&gt; Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex2/return_value_metrics.json
</pre></div></div>
</div>
<p>In this case, the results JSON contains more statistics.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="n">output_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">demo_output_directory</span><span class="p">,</span> <span class="s2">&quot;extremes_ex2/GISS-E2-H_block_extremes_metrics.json&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">metric</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)[</span><span class="s2">&quot;RESULTS&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{
  &#34;GISS-E2-H&#34;: {
    &#34;r6i1p1&#34;: {
      &#34;Rx1day&#34;: {
        &#34;land&#34;: {
          &#34;bias_xy&#34;: {
            &#34;ANN&#34;: -2.9638201041287924,
            &#34;DJF&#34;: -2.495281430585827,
            &#34;JJA&#34;: -0.2946765460481996,
            &#34;MAM&#34;: -1.5971789954641609,
            &#34;SON&#34;: -1.6977973313872894
          },
          &#34;cor_xy&#34;: {
            &#34;ANN&#34;: 0.6837044814847419,
            &#34;DJF&#34;: 0.9684347121108853,
            &#34;JJA&#34;: 0.8459034898918713,
            &#34;MAM&#34;: 0.8129768025803042,
            &#34;SON&#34;: 0.8747028133107926
          },
          &#34;mae_xy&#34;: {
            &#34;ANN&#34;: 4.685738060858886,
            &#34;DJF&#34;: 4.098482865854706,
            &#34;JJA&#34;: 3.189920892588137,
            &#34;MAM&#34;: 3.519019913781204,
            &#34;SON&#34;: 3.067846179868978
          },
          &#34;mean&#34;: {
            &#34;ANN&#34;: 13.893658659590225,
            &#34;DJF&#34;: 9.31502969871792,
            &#34;JJA&#34;: 9.874547701271384,
            &#34;MAM&#34;: 9.673421213370716,
            &#34;SON&#34;: 10.26557454847975
          },
          &#34;pct_dif&#34;: {
            &#34;ANN&#34;: -66.8082970235577,
            &#34;DJF&#34;: -80.28406965543556,
            &#34;JJA&#34;: -11.011054941202895,
            &#34;MAM&#34;: -53.84901064903107,
            &#34;SON&#34;: -53.926648100473614
          },
          &#34;rms_xy&#34;: {
            &#34;ANN&#34;: 6.158825385201947,
            &#34;DJF&#34;: 5.5348495442351435,
            &#34;JJA&#34;: 4.457176775824264,
            &#34;MAM&#34;: 4.843059889942635,
            &#34;SON&#34;: 4.2149516325799965
          },
          &#34;rmsc_xy&#34;: {
            &#34;ANN&#34;: 13.543723552492386,
            &#34;DJF&#34;: 10.006858144663193,
            &#34;JJA&#34;: 8.713505649340128,
            &#34;MAM&#34;: 9.479984080166622,
            &#34;SON&#34;: 9.622265181792287
          },
          &#34;std-obs_xy&#34;: {
            &#34;ANN&#34;: 8.460047158200908,
            &#34;DJF&#34;: 6.663753740526669,
            &#34;JJA&#34;: 5.556742814616796,
            &#34;MAM&#34;: 6.022988998851917,
            &#34;SON&#34;: 6.280888402234044
          },
          &#34;std_xy&#34;: {
            &#34;ANN&#34;: 5.945030862687258,
            &#34;DJF&#34;: 6.146237023726763,
            &#34;JJA&#34;: 5.5616445472124205,
            &#34;MAM&#34;: 5.691253427868338,
            &#34;SON&#34;: 4.706666979280209
          }
        }
      },
      &#34;Rx5day&#34;: {
        &#34;land&#34;: {
          &#34;bias_xy&#34;: {
            &#34;ANN&#34;: -0.33917185914832654,
            &#34;DJF&#34;: -0.38991880664836837,
            &#34;JJA&#34;: 0.7233060324395061,
            &#34;MAM&#34;: 0.016367233863598916,
            &#34;SON&#34;: -0.05164734025943446
          },
          &#34;cor_xy&#34;: {
            &#34;ANN&#34;: 0.7975986941318791,
            &#34;DJF&#34;: 1.0614730586402408,
            &#34;JJA&#34;: 0.9415359797200796,
            &#34;MAM&#34;: 0.9483063370862885,
            &#34;SON&#34;: 0.9365535144620619
          },
          &#34;mae_xy&#34;: {
            &#34;ANN&#34;: 2.246793312811029,
            &#34;DJF&#34;: 1.944207191163086,
            &#34;JJA&#34;: 2.1452026697714044,
            &#34;MAM&#34;: 1.8653627522017895,
            &#34;SON&#34;: 1.6125921503923708
          },
          &#34;mean&#34;: {
            &#34;ANN&#34;: 8.671242963046646,
            &#34;DJF&#34;: 5.676891390638716,
            &#34;JJA&#34;: 6.3377633184316595,
            &#34;MAM&#34;: 5.979513632245038,
            &#34;SON&#34;: 6.398284822480362
          },
          &#34;pct_dif&#34;: {
            &#34;ANN&#34;: -14.303628094408946,
            &#34;DJF&#34;: -24.422209800808893,
            &#34;JJA&#34;: 48.953696182196545,
            &#34;MAM&#34;: 1.042968037591726,
            &#34;SON&#34;: -3.042734069238085
          },
          &#34;rms_xy&#34;: {
            &#34;ANN&#34;: 3.1524699315330738,
            &#34;DJF&#34;: 2.8539928314777017,
            &#34;JJA&#34;: 2.9890377112319646,
            &#34;MAM&#34;: 2.5737013801878934,
            &#34;SON&#34;: 2.233005422299144
          },
          &#34;rmsc_xy&#34;: {
            &#34;ANN&#34;: 7.341785199420232,
            &#34;DJF&#34;: 5.289257452710296,
            &#34;JJA&#34;: 5.052260285355741,
            &#34;MAM&#34;: 5.092112589680367,
            &#34;SON&#34;: 5.250734845752278
          },
          &#34;std-obs_xy&#34;: {
            &#34;ANN&#34;: 4.678522874655352,
            &#34;DJF&#34;: 3.621532272277169,
            &#34;JJA&#34;: 3.2163523875175306,
            &#34;MAM&#34;: 3.33323565469098,
            &#34;SON&#34;: 3.488610711147975
          },
          &#34;std_xy&#34;: {
            &#34;ANN&#34;: 4.360349983232101,
            &#34;DJF&#34;: 4.075258006799149,
            &#34;JJA&#34;: 4.252590359970838,
            &#34;MAM&#34;: 3.9340937638845,
            &#34;SON&#34;: 3.5241812625764277
          }
        }
      }
    }
  }
}
</pre></div></div>
</div>
<p>Similarly, the return value metrics JSON shows more metrics comparing the model and observed return values.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="n">output_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">demo_output_directory</span><span class="p">,</span> <span class="s2">&quot;extremes_ex2/return_value_metrics.json&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">metric</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)[</span><span class="s2">&quot;RESULTS&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{
  &#34;GISS-E2-H&#34;: {
    &#34;r6i1p1&#34;: {
      &#34;Rx1day&#34;: {
        &#34;land&#34;: {
          &#34;bias_xy&#34;: {
            &#34;ANN&#34;: -3.772317802925131,
            &#34;DJF&#34;: -2.8204298940888224,
            &#34;JJA&#34;: -0.7104342862321072,
            &#34;MAM&#34;: -2.0548532566379154,
            &#34;SON&#34;: -1.9267126342291894
          },
          &#34;cor_xy&#34;: {
            &#34;ANN&#34;: 0.6953329102062709,
            &#34;DJF&#34;: 1.0144557369093798,
            &#34;JJA&#34;: 0.8717147420454912,
            &#34;MAM&#34;: 0.8570303881672487,
            &#34;SON&#34;: 0.8547260892720185
          },
          &#34;mae_xy&#34;: {
            &#34;ANN&#34;: 5.212922565882905,
            &#34;DJF&#34;: 4.239025302742928,
            &#34;JJA&#34;: 3.511290894780589,
            &#34;MAM&#34;: 3.617308119033,
            &#34;SON&#34;: 3.422695495665447
          },
          &#34;mean&#34;: {
            &#34;ANN&#34;: 13.624745420109296,
            &#34;DJF&#34;: 9.135198382216965,
            &#34;JJA&#34;: 9.69544213448287,
            &#34;MAM&#34;: 9.494820971523852,
            &#34;SON&#34;: 10.085447982915195
          },
          &#34;pct_dif&#34;: {
            &#34;ANN&#34;: -82.39550400308971,
            &#34;DJF&#34;: -89.64252661175453,
            &#34;JJA&#34;: -25.94277517225058,
            &#34;MAM&#34;: -67.60553618236206,
            &#34;SON&#34;: -60.94905800323612
          },
          &#34;rms_xy&#34;: {
            &#34;ANN&#34;: 6.799522859091312,
            &#34;DJF&#34;: 5.783533715648842,
            &#34;JJA&#34;: 4.849648962808867,
            &#34;MAM&#34;: 5.140713726278351,
            &#34;SON&#34;: 4.848500076949931
          },
          &#34;rmsc_xy&#34;: {
            &#34;ANN&#34;: 14.011555296387773,
            &#34;DJF&#34;: 10.153746254129677,
            &#34;JJA&#34;: 9.044531409187776,
            &#34;MAM&#34;: 9.727692917047234,
            &#34;SON&#34;: 9.906336169092766
          },
          &#34;std-obs_xy&#34;: {
            &#34;ANN&#34;: 5.84905794939727,
            &#34;DJF&#34;: 6.013623428632656,
            &#34;JJA&#34;: 5.727349593864466,
            &#34;MAM&#34;: 5.823259373316453,
            &#34;SON&#34;: 4.879802456134834
          },
          &#34;std_xy&#34;: {
            &#34;ANN&#34;: 5.84905794939727,
            &#34;DJF&#34;: 6.013623428632656,
            &#34;JJA&#34;: 5.727349593864466,
            &#34;MAM&#34;: 5.823259373316453,
            &#34;SON&#34;: 4.879802456134834
          }
        }
      },
      &#34;Rx5day&#34;: {
        &#34;land&#34;: {
          &#34;bias_xy&#34;: {
            &#34;ANN&#34;: -0.6689568518426141,
            &#34;DJF&#34;: -0.4649576550476801,
            &#34;JJA&#34;: 0.4432814449040144,
            &#34;MAM&#34;: -0.28804918489369696,
            &#34;SON&#34;: -0.09186559287153301
          },
          &#34;cor_xy&#34;: {
            &#34;ANN&#34;: 0.7897175107203418,
            &#34;DJF&#34;: 1.0432040182169595,
            &#34;JJA&#34;: 0.9568041308531043,
            &#34;MAM&#34;: 0.9744603276841419,
            &#34;SON&#34;: 0.9256014276768241
          },
          &#34;mae_xy&#34;: {
            &#34;ANN&#34;: 2.43575621494916,
            &#34;DJF&#34;: 2.1275398910641865,
            &#34;JJA&#34;: 2.24245804570134,
            &#34;MAM&#34;: 1.9322676715282434,
            &#34;SON&#34;: 1.8028077830317968
          },
          &#34;mean&#34;: {
            &#34;ANN&#34;: 8.612002894301867,
            &#34;DJF&#34;: 5.639755083301711,
            &#34;JJA&#34;: 6.327901109603924,
            &#34;MAM&#34;: 5.881137864856613,
            &#34;SON&#34;: 6.4227782133202105
          },
          &#34;pct_dif&#34;: {
            &#34;ANN&#34;: -27.389014158119508,
            &#34;DJF&#34;: -28.941387809171086,
            &#34;JJA&#34;: 28.624132739473623,
            &#34;MAM&#34;: -17.742299067561806,
            &#34;SON&#34;: -5.358378529994827
          },
          &#34;rms_xy&#34;: {
            &#34;ANN&#34;: 3.3983206619821558,
            &#34;DJF&#34;: 3.1274141776424766,
            &#34;JJA&#34;: 3.141553282208936,
            &#34;MAM&#34;: 2.630126131170074,
            &#34;SON&#34;: 2.522403251893798
          },
          &#34;rmsc_xy&#34;: {
            &#34;ANN&#34;: 7.607010019233525,
            &#34;DJF&#34;: 5.458755205252023,
            &#34;JJA&#34;: 5.336073364645669,
            &#34;MAM&#34;: 5.243825916009218,
            &#34;SON&#34;: 5.4218208680489575
          },
          &#34;std-obs_xy&#34;: {
            &#34;ANN&#34;: 4.350524537048482,
            &#34;DJF&#34;: 4.133374175749511,
            &#34;JJA&#34;: 4.293717108920656,
            &#34;MAM&#34;: 3.970563425657647,
            &#34;SON&#34;: 3.6943723619808524
          },
          &#34;std_xy&#34;: {
            &#34;ANN&#34;: 4.350524537048482,
            &#34;DJF&#34;: 4.133374175749511,
            &#34;JJA&#34;: 4.293717108920656,
            &#34;MAM&#34;: 3.970563425657647,
            &#34;SON&#34;: 3.6943723619808524
          }
        }
      }
    }
  }
}
</pre></div></div>
</div>
<p>Along with the JSON file of metrics, this driver can also produce a set of diagnostic plots and save the block extrema data as netcdf files.</p>
<div class="line-block">
<div class="line">To save the netcdf files, use the flag “–nc_out” on the command line or nc_out = True in the parameter file.</div>
<div class="line">To generate plots, use the flag “–plots” on the command line or plots = True in the parameter file.</div>
</div>
<p>The diagnostics plots will always display a world map. If a reference data set is included, Taylor Diagrams will be produced for each model. Users can access the same underlying data in the output netcdf files and metrics JSONs to generate their own visualizations.</p>
<p>The next cell demonstrates these flags.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>%%bash
extremes_driver.py<span class="w">  </span>-p<span class="w"> </span>basic_extremes_param.py<span class="w"> </span>--case_id<span class="w"> </span><span class="s2">&quot;extremes_ex3&quot;</span><span class="w"> </span>--plots
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
No sftlf file found for GISS-E2-H r6i1p1

-----------------------
model, run, variable: GISS-E2-H r6i1p1 pr
test_data (model in this case) full_path:
   demo_output/extremes_tmp/pr_day_GISS-E2-H_historical_r6i1p1_20000101-20051231.nc
Generating land sea mask.
Generating precipitation block extrema.
Writing results to netCDF.
Creating maps
Generating metrics.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO::2023-12-23 10:09::pcmdi_metrics:: Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex3/GISS-E2-H_block_extremes_metrics.json
2023-12-23 10:09:43,553 [INFO]: base.py(write:251) &gt;&gt; Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex3/GISS-E2-H_block_extremes_metrics.json
2023-12-23 10:09:43,553 [INFO]: base.py(write:251) &gt;&gt; Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex3/GISS-E2-H_block_extremes_metrics.json
INFO::2023-12-23 10:09::pcmdi_metrics:: Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex3/block_extremes_metrics.json
2023-12-23 10:09:59,431 [INFO]: base.py(write:251) &gt;&gt; Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex3/block_extremes_metrics.json
2023-12-23 10:09:59,431 [INFO]: base.py(write:251) &gt;&gt; Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex3/block_extremes_metrics.json
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generating return values.
demo_output/extremes_ex3/netcdf/GISS-E2-H_r6i1p1_land_Rx5day_2000-2005.nc
Return value for single realization
Stationary case
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:484: RuntimeWarning: invalid value encountered in sqrt
  se = np.sqrt(np.diag(B))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
demo_output/extremes_ex3/netcdf/GISS-E2-H_r6i1p1_land_Rx1day_2000-2005.nc
Return value for single realization
Stationary case
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:484: RuntimeWarning: invalid value encountered in sqrt
  se = np.sqrt(np.diag(B))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
2023-12-23 10:14:29,933 [WARNING]: dataset.py(open_dataset:128) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
2023-12-23 10:14:29,933 [WARNING]: dataset.py(open_dataset:128) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
2023-12-23 10:14:30,960 [WARNING]: dataset.py(open_dataset:128) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
2023-12-23 10:14:30,960 [WARNING]: dataset.py(open_dataset:128) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
INFO::2023-12-23 10:14::pcmdi_metrics:: Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex3/return_value_metrics.json
2023-12-23 10:14:47,566 [INFO]: base.py(write:251) &gt;&gt; Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex3/return_value_metrics.json
2023-12-23 10:14:47,566 [INFO]: base.py(write:251) &gt;&gt; Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex3/return_value_metrics.json
</pre></div></div>
</div>
<p>The plots and netcdf files can be found in the output directory. The next cell will display the map. The contours are rough on this map because this demo uses data with very low spatial resolution.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">HTML</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">HTML</span>

<span class="n">Image</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="n">demo_output_directory</span> <span class="o">+</span> <span class="s2">&quot;/extremes_ex3/plots/maps/GISS-E2-H_r6i1p1_land_Rx1day_ANN.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Demo_8_extremes_29_0.png" src="../_images/examples_Demo_8_extremes_29_0.png" />
</div>
</div>
<p>The examples in this notebook produce return values assuming that the data is stationary in time. The Extremes Driver also has an option to produce nonstationary return values for model data only.</p>
<p>To generate nonstationary return values, the user must provide two variables:</p>
<div class="line-block">
<div class="line">–covariate_path: Path to covariate time series netcdf file. The only dimension should be time, in years (with time bounds).</div>
<div class="line">–covariate: Name of covariate variable in file given by –covariate_path.</div>
</div>
<p>This static example would run the driver with a covariate file “covariate_file.nc” that contains the variable “mole_fraction_or_carbon_dioxide_in_air”:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>extremes_driver.py -p basic_extremes_param.py --covariate_path ./covariate_file.nc --covariate &quot;mole_fraction_of_carbon_dioxide_in_air&quot;
</pre></div>
</div>
<p>Users can define a custom region over which to calculate the extremes metrics. There are two way to do this.</p>
<section id="Coordinate-method">
<h3>Coordinate method<a class="headerlink" href="#Coordinate-method" title="Link to this heading">#</a></h3>
<p>The first method is to provide coordinate pairs that define a contiguous region. This region does not have to be rectangular, but it cannot have holes.</p>
<p>The following example provides lon/lat pairs that define the western hemisphere. The region name flag “–region_name” is optional in this case.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>%%bash
extremes_driver.py<span class="w">  </span>-p<span class="w"> </span>basic_extremes_param.py<span class="w"> </span><span class="se">\</span>
--case_id<span class="w"> </span><span class="s2">&quot;extremes_ex4&quot;</span><span class="w"> </span><span class="se">\</span>
--plots<span class="w"> </span><span class="se">\</span>
--region_name<span class="w"> </span><span class="s2">&quot;WestHemi&quot;</span><span class="w"> </span><span class="se">\</span>
--coords<span class="w"> </span><span class="o">[[</span><span class="m">180</span>,-90<span class="o">]</span>,<span class="o">[</span><span class="m">360</span>,-90<span class="o">]</span>,<span class="o">[</span><span class="m">360</span>,90<span class="o">]</span>,<span class="o">[</span><span class="m">180</span>,90<span class="o">]]</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Region settings are:
  Coordinates: [[180.0, -90.0], [360.0, -90.0], [360.0, 90.0], [180.0, 90.0]]
  Region name: WestHemi

Metrics output path not found.
Creating metrics output directory demo_output/extremes_ex4
No sftlf file found for GISS-E2-H r6i1p1

-----------------------
model, run, variable: GISS-E2-H r6i1p1 pr
test_data (model in this case) full_path:
   demo_output/extremes_tmp/pr_day_GISS-E2-H_historical_r6i1p1_20000101-20051231.nc
Generating land sea mask.

Creating sftlf region mask.
Creating dataset mask.
Generating precipitation block extrema.
Writing results to netCDF.
Creating maps
Generating metrics.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO::2023-12-23 10:15::pcmdi_metrics:: Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex4/GISS-E2-H_block_extremes_metrics.json
2023-12-23 10:15:25,709 [INFO]: base.py(write:251) &gt;&gt; Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex4/GISS-E2-H_block_extremes_metrics.json
2023-12-23 10:15:25,709 [INFO]: base.py(write:251) &gt;&gt; Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex4/GISS-E2-H_block_extremes_metrics.json
INFO::2023-12-23 10:15::pcmdi_metrics:: Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex4/block_extremes_metrics.json
2023-12-23 10:15:40,415 [INFO]: base.py(write:251) &gt;&gt; Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex4/block_extremes_metrics.json
2023-12-23 10:15:40,415 [INFO]: base.py(write:251) &gt;&gt; Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex4/block_extremes_metrics.json
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generating return values.
demo_output/extremes_ex4/netcdf/GISS-E2-H_r6i1p1_WestHemi_Rx5day_2000-2005.nc
Return value for single realization
Stationary case
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
demo_output/extremes_ex4/netcdf/GISS-E2-H_r6i1p1_WestHemi_Rx1day_2000-2005.nc
Return value for single realization
Stationary case
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1583: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:401: RuntimeWarning: overflow encountered in exp
  result = np.sum(n * np.log(scale) + y + np.exp(-y))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:484: RuntimeWarning: invalid value encountered in sqrt
  se = np.sqrt(np.diag(B))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numdifftools/limits.py:150: UserWarning: All-NaN slice encountered
  warnings.warn(str(msg))
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/pcmdi_metrics/extremes/lib/return_value.py:409: RuntimeWarning: overflow encountered in power
  np.log(scale) + y ** (-1 / shape) + np.log(y) * (1 / shape + 1)
2023-12-23 10:17:07,225 [WARNING]: dataset.py(open_dataset:128) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
2023-12-23 10:17:07,225 [WARNING]: dataset.py(open_dataset:128) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
2023-12-23 10:17:08,197 [WARNING]: dataset.py(open_dataset:128) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
2023-12-23 10:17:08,197 [WARNING]: dataset.py(open_dataset:128) &gt;&gt; &#34;No time coordinates were found in this dataset to decode. If time coordinates were expected to exist, make sure they are detectable by setting the CF &#39;axis&#39; or &#39;standard_name&#39; attribute (e.g., ds[&#39;time&#39;].attrs[&#39;axis&#39;] = &#39;T&#39; or ds[&#39;time&#39;].attrs[&#39;standard_name&#39;] = &#39;time&#39;). Afterwards, try decoding again with `xcdat.decode_time`.&#34;
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/lee1043/mambaforge/envs/pmp_devel_20231129/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1878: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
INFO::2023-12-23 10:17::pcmdi_metrics:: Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex4/return_value_metrics.json
2023-12-23 10:17:26,185 [INFO]: base.py(write:251) &gt;&gt; Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex4/return_value_metrics.json
2023-12-23 10:17:26,185 [INFO]: base.py(write:251) &gt;&gt; Results saved to a json file: /Users/lee1043/Documents/Research/git/pcmdi_metrics_20230620_pcmdi/pcmdi_metrics/doc/jupyter/Demo/demo_output/extremes_ex4/return_value_metrics.json
</pre></div></div>
</div>
<p>Viewing the automatic plots verifies that the region of interest has been used. Again, the contours will look rough because of the low spatial resolution of the demo data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">HTML</span>

<span class="n">Image</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="n">demo_output_directory</span> <span class="o">+</span> <span class="s2">&quot;/extremes_ex4/plots/maps/GISS-E2-H_r6i1p1_WestHemi_Rx1day_ANN.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Demo_8_extremes_36_0.png" src="../_images/examples_Demo_8_extremes_36_0.png" />
</div>
</div>
</section>
<section id="Shapefile-method">
<h3>Shapefile method<a class="headerlink" href="#Shapefile-method" title="Link to this heading">#</a></h3>
<p>The second method is to provide a shapefile containing the region of interest. The region of interest must be completely defined by a single, uniquely identifiable feature in the shapefile. For example, if the region of interest is the fifty states of the USA, there must be a single feature in the shapefile that contains all the land areas of all fifty states. The –region_name flag is required in this case.</p>
<div class="line-block">
<div class="line">–shp_path is the path of the shapefile containing your region</div>
<div class="line">–region_name must match the name of your region as recorded under the shapefile attribute “–attribute”</div>
</div>
<p>Here is a static example of a command to get metrics for a region called “CANADA” under the “COUNTRY” attribute in a shapefile called “world_countries.shp”:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>extremes_driver.py -p basic_extremes_param.py --shp_path world_countries.shp --attribute &quot;COUNTRY&quot; --region_name &quot;CANADA&quot;
</pre></div>
</div>
</section>
</section>
<section id="Other-options">
<h2>Other options<a class="headerlink" href="#Other-options" title="Link to this heading">#</a></h2>
<p>Consult the <a href="#id1"><span class="problematic" id="id2">`README file &lt;&gt;`__</span></a> for the extremes metrics to find the full set of user options.</p>
</section>
<section id="Clean-up">
<h2>Clean up<a class="headerlink" href="#Clean-up" title="Link to this heading">#</a></h2>
<p>Run this cell to delete the low resolution datasets we created at the start of this demo.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>%%bash<span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$demo_output_directory</span><span class="s2">&quot;</span>
rm<span class="w"> </span>-r<span class="w"> </span><span class="nv">$1</span>/extremes_tmp
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Demo_7_precip_variability.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">7. Precipitation Variability Across Timescales</p>
      </div>
    </a>
    <a class="right-next"
       href="Demo_9_seaIceExtent_ivanova.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">9A. Sea Ice</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Create-low-resolution-datasets">Create low resolution datasets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Basic-Use">Basic Use</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#How-to-run">How to run</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Customizing-parameters-in-the-extremes-driver">Customizing parameters in the extremes driver</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Coordinate-method">Coordinate method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Shapefile-method">Shapefile method</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Other-options">Other options</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Clean-up">Clean up</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By PMP Developers
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024, PMP Developers.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>